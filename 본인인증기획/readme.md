# 본인인증 기획

# 0. 기획회의에서 합의된 내용

```
1. 구름 Admin에서 본인인증 강제 기능
    1. 본인인증 설정 페이지에서 채널별로 모든 멤버에 대해 개별적으로 본인인증 강제 여부를 설정할 수 있다.
    2. 채널별로 모든 멤버의 본인인증 완료 여부를 조회할 수 있다.
2. 특정 채널 Admin에서 본인인증 강제 기능
    1. 본인인증 설정 페이지에서 모든 멤버에 대해 개별적으로 본인인증 강제 여부를 설정할 수 있다.
    2. 해당 채널 모든 멤버의 본인인증 완료 여부를 조회할 수 있다.
3. 채널 멤버의 상태에 따른 플로우
    1. **신규 유저**의 경우 (**채널 미가입 멤버**인 경우)
        1. 회원 가입 → 관리자의 수락 → 채널 멤버로서 **첫 로그인 시** 본인인증
    2. **채널에 가입된 유저**의 경우 (**채널의 멤버**인 경우)
        1. 관리자가 본인인증 강제를 설정한 경우, 유저의 **첫 로그인 시** 본인인증
4. 채널 진입 시 본인인증 플로우 예시
    1. (개발자 설명) 구름 로그인 ➝ 본인 인증 페이지 ➝ 본인 인증 thirdparty ➝ 구름 페이지로 ➝ 완료
```

# 1. Actor

1. 채널 Admin 관리자
2. 채널의 멤버
3. 구름 Admin 관리자

# 2. 기능 요구사항과 Usecase


- **채널 Admin 관리자**는
  - 본인 인증 설정 페이지에서
    - (UCA1) 해당 채널의 모든 멤버에 대해 개별적으로 본인 인증이 1회 강제 되도록 설정할 수 있다.
      - 이 설정은 이후 off 할 수 있다.
    - (UCA2) 해당 채널의 모든 구성원을 대상으로 본인 인증 완료 여부를 조회할 수 있다.


- (Q1) 본인 인증 강제가 ON -> OFF -> ON 될 시 기존 본인인증 내역은 유지되는가
  - 유지된다.


- (Q2) 1회 본인인증 강제는 어느 시점에 진행되는가?
  - 첫 로그인 시 본인인증이 강제된다.


- (Q3) 채널의 모든 구성원 범위가 어디까지인가?
  - 채널 관리자와 채널 멤버 모두를 포함한다.


- (Q4) UGA2에서 본인인증 강제가 OFF 인 상태에서도 본인인증 완료 여부를 조회할 수 있는가?
  - 이전까지의 완료 내역을 조회할 수 있다.

- (Q5) 채널 Admin 관리자가 스스로 본인 인증을 강제하는 플로우도 존재하는가?
  - 존재한다.


- **채널 멤버**는
  - (UCM1) 본인 인증이 강제된 채널에 가입한 경우 로그인 시 팝업창을 통해 본인 인증을 진행할 수 있다.
  - (UCM2) 이전에 다른 채널에서 본인 인증을 완료한 경우 본인 인증을 하지 않아도 채널의 콘텐츠를 이용할 수 있다.


- **구름 Admin 관리자**는
    - (UGA1) 모든 채널의 본인인증 설정 페이지에 접근할 수 있다.
    - (UGA2) 접근한 설정페이지에서 (UCA1)을 수행할 수 있다. 
    - (UGA3) 접근한 설정페이지에서 (UCA2)를 수행할 수 있다. 


# 3. Sequence


---

> **W18 이전 기획**

## 0. 도메인 용어 정리

- 채널이 뭔지 서비스 관점에서 정리
  - 채널: 기업, 기관, 대학 맞춤형 SW 교육 플랫폼(LMS, 콘텐츠, 실습 환경 통합 제공)
    - 채널 별로 학습 회원, 관리자 회원이 존재
- KDT, KDC 어떤 프로그램인지 정리
  - KDT(K-Digital Training): 디지털 핵심 실무 인재 양성 사업 
  - KDC(K-Digital Credit): 디지털 기초 역량 훈련
- 도메인 Actor 누구인지 정리
  - 기업, 기관, 대학의 채널 관리자
  - 기업, 기관, 대학의 채널 소속 수강생
  - KDT/KDC 채널 관리자
  - KDT/KDC 채널 훈련생
- 구름 서비스 안에서 mOTP 기능이 무엇이고 어떻게 정확히 동작하는지(기술 관점이 아니라 Role 관점에서)
  - 훈련생 인증 시스템으로 추가 제공되는 mOTP(모바일 일회용 비밀번호) 서비스의 연동
  - mOTP 인증, 본인인증 증 하나의 수단을 통해서 반드시 인증이 이루어져야 함

## 1. Actor 와 시스템

- Actor
  - KDT/KDC 채널 관리자
    - `TODO`: 관리자에게는 어떤 Flow를 제공해야하는지
  - KDT/KDC 채널 훈련생

  
- 외부 시스템
  - K-Digital에서 제공하는 mOTP 앱


- 구름 내부 연동 시스템
  - public mOTP
    - 의 Role은?
      - 훈련생 인증 체계 고도화를 위한 mOTP 연동
      - 출결 관리 (모바일 환경에서 구동 가능한 mOTP를 이용하여 인증을 수행)


- 개발할 시스템
  - 본인 인증 시스템
    - 의 Role은?
      - 채널에 본인 인증을 기반으로 채널의  


한국산업인력공단이 제공하는 mOTP 앱 (서버)

public mOTP : mOTP랑 Channel이랑 연동하는 내부 모듈 (클라이언트) -> 애를 사용해서 인증할 수 있음

(TODO) channel의 인증기능: 
  - 출석체크는 mOTP로 자동으로 되는건지? 출석체크도 해줘야되는건지 
  - 

## 2, 기능 요구사항 정리


### 1. 관리자 페이지 내 출결 관리 기능

- Prerequisites
  - KDT, KDC 채널에서만 제공한다.


- Requirements
  - (1) 강좌 내 강의별 출결기록 조회 기능 (**출결과 개인정보(휴대폰/이름) 조회**)
  - (2) 한국산업인력공단으로 **출결 내역을 제출하는 기능**

### 2. 학습자 출결 시 본인인증 강제 기능

- Prerequisites
  - 구름 public mOTP 모듈을 이용한다.
    - c.f.) 구름 public mOTP 모듈은 mOTP 인증 실패 시 제 2의 본인인증 수단을 사용자에게 제공함
  - KDT, KDC 채널에서만 제공한다.


- Requirements
  - (1) 사용자가 수강페이지에서 출결 버튼 클릭 시 본인인증 페이지로 연결 해 본인 인증이 성공해야 출석을 인정한다. 
    - 퇴장 버튼 클릭 시에는 본인인증을 강제하지 않는다.

### 3. 채널 별 본인 인증 기반의 회원가입 기능 제공 

- Requirements
  - (1) 관리자가 학습 계정 생성 시
    - 학습자가 해당 계정으로 첫 로그인하면 본인인증 팝업이 생성
      - 구름 내부 DB에 계정에 해당하는 학습자 이름과 휴대폰 번호를 저장
  - (2) 학습자가 스스로 계정 생성 시
    - 회원 가입 페이지에서 본인인증을 강제
      - 구름 내부 DB에 계정에 해당하는 학습자 이름과 휴대폰 번호를 저장

### (Optional) 4. 채널 생성 시 본인 인증 기반의 회원가입을 강제하는 옵션을 제공 

- Requirements 
  - 관리자 계정에서 채널 생성시 3.의 기능을 제공할 지를 선택하는 옵션을 제공
    - 논의 필요한 사항: 이미 생성된 채널은 적용 불가능한데, 차라리 나중에 관리 페이지에서 회원 가입 시 본인인증을 강제하도록 하는 기능이 필요한게 아닌지?


## 3. 케이스 스터디

- 정부 국비지원 프로그램에서 어떻게 출석과 본인인증을 하고 있는지 조사

